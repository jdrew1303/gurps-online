<md-content class="md-padding characterProfile"  layout-xs="row" layout="column" ng-cloak>
    <div layout layout-align="center center">
        <h4 flex> Campaign: {{character.campaign.name}} </h4>
        <md-button class="md-raised md-primary" aria-label="join"
                   ng-if="!character.campaign"
                   ng-click="showJoin()">
            JOIN
        </md-button>
        <md-button class="md-raised" aria-label="leave" style="color: white; background-color: #F44336"
                   ng-if="character.campaign"
                   ng-click="leave()">
            LEAVE
        </md-button>
        <md-button class="md-raised" style="background-color: #388E3C; color: white" aria-label="leave"
                   ng-click="goToAction()">
            Actions
        </md-button>
    </div>
    <div layout layout-align="end end">
        <md-button class="md-raised" aria-label="leave"
                   ng-click="editOnOff()">
            EDIT
        </md-button>
        <md-button class="md-raised" aria-label="leave" ng-if="edit"
                   ng-click="saveChange()">
            Save
        </md-button>
    </div>
    <h1 class="text-korinna">Experience left: {{character.freexp}}</h1>
    <h1 class="text-korinna">Stats</h1>
    <div id="stats">
        <div layout="row">
            <attributes placeholder="Strength (ST)" info="views/characters/info/strength.html" variable="character.strength" cost="10" edit="edit" sub="canEdit" capital="character.freexp" min="1" flex></attributes>
            <attributes placeholder="Dexterity (DX)" info="views/characters/info/dexterity.html" variable="character.dexterity" cost="20" edit="edit" sub="canEdit" capital="character.freexp" min="1" flex></attributes>
            <attributes placeholder="Intelligence (IQ)" info="views/characters/info/intelligence.html" variable="character.intelligence" cost="20" edit="edit" sub="canEdit" capital="character.freexp" min="1" flex></attributes>
            <attributes placeholder="Health (HT)" info="views/characters/info/health.html" variable="character.health" cost="10" edit="edit" sub="canEdit" capital="character.freexp" min="1" flex></attributes>
        </div>
        <div ng-if="canEdit">
            <value-bar name="HP" info="views/characters/info/hitpoints.html" value="character.health" total="character.health"></value-bar>
            <value-bar name="Will" info="views/characters/info/will.html" value="character.intelligence" total="character.intelligence"></value-bar>
            <value-bar name="Stamina" info="views/characters/info/fatigue.html" value="character.health" total="character.health"></value-bar>
        </div>
        <div ng-if="!canEdit">
            <value-bar name="HP" info="views/characters/info/hitpoints.html" value="character.hp" total="character.health"></value-bar>
            <value-bar name="Will" info="views/characters/info/will.html" value="character.will" total="character.intelligence"></value-bar>
            <value-bar name="Stamina" info="views/characters/info/fatigue.html" value="character.fp" total="character.health"></value-bar>
        </div>

        <div layout="row">
            <secondary-attributes placeholder="Perception (Per)" info="views/characters/info/perception.html" variable="character.intelligence"></secondary-attributes>
            <md-divider vertical></md-divider>
            <secondary-attributes placeholder="Basic Speed" info="views/characters/info/speed.html" variable="character.speed"></secondary-attributes>
            <md-divider vertical></md-divider>
            <secondary-attributes placeholder="Dodge" info="views/characters/info/dodge.html" variable="character.dodge"></secondary-attributes>
            <md-divider vertical></md-divider>
            <secondary-attributes placeholder="Basic Move" info="views/characters/info/move.html" variable="character.move"></secondary-attributes>
        </div>
        <div layout="row">
            <h3 class="text-korinna">
                Damage
                <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                         ng-click="showInfo('views/characters/info/damage.html', $event)"></md-icon>
                Thrust: {{character.thrust}}
                Swing: {{character.swing}}
            </h3>
        </div>
    </div>
    <h1 class="text-korinna">Image and Looks</h1>
    <div id="looks">
        <div layout="row">
            <attributes-selector placeholder="Appearance" info="views/characters/info/appearance.html" states="appearances"
                                 edit="canEdit" capital="character.freexp" change="appearanceChange" indexer="appearanceIndex" flex>
            </attributes-selector>
            <attributes placeholder="Charisma" info="views/characters/info/charisma.html" variable="character.charisma" cost="5" min="0" edit="canEdit" capital="character.freexp" flex></attributes>
            <attributes-checkbox placeholder="Voice" info="views/characters/info/voice.html" edit="canEdit" variable="character.voice" capital="character.freexp" cost="10" flex></attributes-checkbox>
        </div>
        <div layout="column" flex>
            <div layout="row">
                <h3 class="text-korinna">
                    Odious Personnal Habits
                    <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                             ng-click="showInfo('views/characters/info/oph.html', $event)"></md-icon>
                </h3>
            </div>
            <div layout="row" ng-if="canEdit">
                <md-input-container style="padding-right: 10px" flex>
                    <label>Title</label>
                    <input ng-model="chipText" ng-disabled="!canEdit">
                </md-input-container>
                <md-select ng-model="chipType" placeholder="Type" class="md-no-underline" flex="20" ng-disabled="!canEdit">
                    <md-option ng-repeat="type in types" ng-value="type" ng-selected="$index === 0">{{type.title}} ({{-type.cost}})</md-option>
                </md-select>
                <md-button class="md-fab md-mini md-primary" aria-label="add" ng-click="addchips(chipType, chipText)" ng-disabled="!canEdit">
                    <md-icon md-font-icon="fa-plus" class="fa md-primary"></md-icon>
                </md-button>
            </div>
            <div layout="row">
                <md-chips ng-model="character.habits" readonly="false"
                          md-transform-chip="transformChip($chip)" md-on-remove="removeChips($chip)" flex>
                    <md-chip-template>
                        <span>
                          <strong>{{$chip.description}}</strong>
                          <em>({{$chip.type}})</em>
                        </span>
                    </md-chip-template>
                </md-chips>
            </div>
        </div>
    </div>
    <h1 class="text-korinna">Wealth and Influence</h1>
    <div id="wealth">
        <div layout="row" flex>
            <attributes-selector placeholder="Wealth" info="views/characters/info/wealth.html" states="wealths"
                                 edit="canEdit" capital="character.freexp" change="wealthChange" indexer="wealthIndex" flex>
            </attributes-selector>
            <attributes placeholder="Status" info="views/characters/info/status.html" variable="character.statusbonus" cost="5" min="-2" max="8" edit="canEdit" capital="character.freexp" flex></attributes>
        </div>
        <div layout="column" flex>
            <div layout="row">
                <h3 class="text-korinna">
                    Reputation
                    <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                             ng-click="showInfo('views/characters/info/reputation.html', $event)"></md-icon>
                </h3>
            </div>
            <div layout="row" ng-if="canEdit">
                <md-input-container style="padding-right: 10px" flex="70">
                    <label>Title</label>
                    <input ng-model="repText">
                </md-input-container>
                <number-picker number="level" edit="canEdit" min="-4" max="4" flex>
                    <label class="text-korinna">-5 points/level</label>
                </number-picker>
                <md-button class="md-fab md-mini md-primary" aria-label="add" ng-click="addReputation(level)">
                    <md-icon md-font-icon="fa-plus" class="fa md-primary"></md-icon>
                </md-button>
            </div>
            <div layout="row">
                <md-list flex>
                    <md-list-item class="md-2-line" ng-repeat="item in character.reputations"
                                  ng-click="null" layout="row">
                        <div class="md-list-item-text" layout="column">
                            <h3><b>Name:</b> {{ item.what }}</h3>
                            <h4><b>Bonus:</b> {{ item.bonus }}</h4>
                        </div>
                        <md-button class="md-icon-button md-fab md-mini" aria-label="delete" ng-if="canEdit"
                                   ng-click="deleteReputation(item, $index)" style="background-color: red;">
                            <md-icon md-font-icon="fa-minus" class="md-primary fa"></md-icon>
                        </md-button>
                    </md-list-item>
                </md-list>
            </div>
        </div>
    </div>
    <h1 class="text-korinna">Advantages</h1>
    <div id="advantages">
        <attributes-catalog index="0" placeholder="Pick an advantage" path="views/characters/advantage/" variables="advantages" edit="canEdit" add="addAdvantage">
            <number-picker number="data.advglevel" edit="canEdit" min="1" flex="10" class="big-number-wrapper"></number-picker>
        </attributes-catalog>
        <div layout="row" flex>
            <md-list flex>
                <md-list-item class="md-2-line" ng-repeat="item in character.advg_pretty" layout="row">
                    <div class="md-list-item-text" layout="column">
                        <h3><b>{{ item.name }}</b><b ng-if="item.haslevel">(lvl: {{item.level}})</b>
                            <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                                     ng-click="showInfo('views/characters/advantage/' + item.info, $event)"></md-icon>
                        </h3>
                        <p>{{item.description}}</p>
                    </div>
                    <md-button class="md-icon-button md-fab md-mini" aria-label="delete" ng-if="canEdit"
                               ng-click="deleteAdvg(item, $index)" style="background-color: red; margin-top: 20px">
                        <md-icon md-font-icon="fa-minus" class="md-primary fa"></md-icon>
                    </md-button>
                </md-list-item>
            </md-list>
        </div>
    </div>
    <h1 class="text-korinna">Disadvantages</h1>
    <div id="disadvantages">
        <attributes-catalog index="1" placeholder="Pick a disadvantage" path="views/characters/disadvantage/" variables="disadvantages" edit="canEdit" add="addDisadvantage"></attributes-catalog>
        <div layout="row" flex>
            <md-list flex>
                <md-list-item class="md-2-line" ng-repeat="item in character.disadvg_pretty" layout="row">
                    <div class="md-list-item-text" layout="column">
                        <h3><b>{{ item.name }}</b>
                            <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                                     ng-click="showInfo('views/characters/disadvantage/' + item.info, $event)"></md-icon>
                        </h3>
                        <p>{{item.description}}</p>
                    </div>
                    <md-button class="md-icon-button md-fab md-mini" aria-label="delete" ng-if="canEdit"
                               ng-click="deleteDisadvg(item, $index)" style="background-color: red; margin-top: 20px">
                        <md-icon md-font-icon="fa-minus" class="md-primary fa"></md-icon>
                    </md-button>
                </md-list-item>
            </md-list>
        </div>
    </div>
    <h1 class="text-korinna">Skills</h1>
    <div id="skills">
        <attributes-catalog index="2" placeholder="Pick a skill" path="views/characters/skills/" variables="skills" edit="canEdit" add="addSkills"></attributes-catalog>
        <div layout="row" flex>
            <md-list flex>
                <md-list-item class="md-2-line" ng-repeat="item in character.skills" layout="row">
                    <div class="md-list-item-text" layout="column">
                        <h3><b>{{ item.name }}</b>
                            <md-icon md-font-icon="fa-info-circle" class="fa md-primary"
                                     ng-click="showInfo('views/characters/skills/' + item.info, $event)"></md-icon>
                        </h3>
                        <p>{{item.desc()}}</p>
                    </div>
                    <md-input-container class="md-icon-float md-block md-input-has-value" style="height: 100%; padding-top: 15px; padding-left: 30px;">
                        <div class="number-picker">
                            <button ng-if="canEdit" class="number-picker--btn" ng-click="downgradeSkill(item)" ng-class="buttonClass">-</button>
                            <div class="number-picker--value">{{item.bonus}}</div>
                            <button ng-if="edit" class="number-picker--btn" ng-click="upgradeSkill(item)" ng-class="buttonClass">+</button>
                        </div>
                    </md-input-container>
                    <md-button class="md-icon-button md-fab md-mini" aria-label="delete" ng-if="canEdit"
                               ng-click="deleteSkills(item, $index)" style="background-color: red; margin-top: 20px">
                        <md-icon md-font-icon="fa-minus" class="md-primary fa"></md-icon>
                    </md-button>
                </md-list-item>
            </md-list>
        </div>
    </div>
    <h1 class="text-korinna">Information</h1>
    <div id="information">
        <div layout="column" flex>
            <textbox placeholder="Background" variable="character.background" flex></textbox>
            <textbox placeholder="Technical Details" variable="character.details" flex></textbox>
            <textbox placeholder="Notes" variable="character.notes" flex></textbox>
        </div>
    </div>
</md-content>
